{% extends 'base.html' %}
{% load static %}

{% block title %}Order Details - {{ order.order_number }} - Sitwell{% endblock %}

{% block extra_css %}
<style>
    .content-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        padding: 25px;
        margin: 20px auto;
        max-width: 800px;
    }
    
    .order-info {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    
    .item {
        display: flex;
        gap: 15px;
        padding: 15px 0;
        border-bottom: 1px solid #dee2e6;
    }
    
    .item:last-child {
        border-bottom: none;
    }
    
    .thumb {
        width: 60px;
        height: 60px;
        border-radius: 8px;
        object-fit: cover;
        border: 1px solid #dee2e6;
        flex: 0 0 60px;
    }
    
    .order-status {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
    }
    
    .status-pending { background: #fff3cd; color: #856404; }
    .status-confirmed { background: #d1ecf1; color: #0c5460; }
    .status-processing { background: #d4edda; color: #155724; }
    .status-shipped { background: #cce7ff; color: #004085; }
    .status-delivered { background: #d4edda; color: #155724; }
    .status-cancelled { background: #f8d7da; color: #721c24; }
    .status-returned { background: #f8d7da; color: #721c24; }
    
    .btn-primary {
        background-color: #db4444;
        border-color: #db4444;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
    }
    
    .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
        margin-right: 10px;
    }
    
    .btn-outline-danger {
        border: 1px solid #dc3545;
        color: #dc3545;
        background: transparent;
        padding: 8px 16px;
        border-radius: 5px;
        text-decoration: none;
    }
</style>
{% endblock %}

{% block banner %}{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'dummy_home' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'user_profile' %}">Profile</a></li>
        <li class="breadcrumb-item"><a href="{% url 'user_orders' %}">My Orders</a></li>
        <li class="breadcrumb-item active">Order #{{ order.order_number }}</li>
    </ol>
</nav>

<div class="content-card">
    <h4 style="color: #db4444; margin-bottom: 20px;">Order Details: #{{ order.order_number }}</h4>
    
    <div class="order-info">
        <h6>Order Summary</h6>
        <p><strong>Order Date:</strong> {{ order.created_at|date:"F d, Y g:i A" }}</p>
        <p><strong>Total Amount:</strong> ₹{{ order.total_amount|floatformat:2 }}</p>
        <p><strong>Status:</strong> <span class="order-status status-{{ order.status }}">{{ order.get_status_display }}</span></p>
        <p><strong>Payment Status:</strong> {{ order.get_payment_status_display }}</p>
        {% if order.tracking_number %}
            <p><strong>Tracking Number:</strong> {{ order.tracking_number }}</p>
        {% endif %}
        <p><strong>Shipping Address:</strong> {{ order.shipping_address }}</p>
    </div>
    
    <h6 style="margin-bottom: 15px;">Items Ordered</h6>
    {% for item in items %}
        <div class="item">
            {% if item.product.images.exists %}
                <img src="{{ item.product.images.first.image.url }}" alt="{{ item.product_name }}" class="thumb">
            {% else %}
                <div class="thumb" style="background: #f8f9fa; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-image" style="color: #6c757d;"></i>
                </div>
            {% endif %}
            <div>
                <strong>{{ item.product_name }}</strong>
                <p style="margin: 5px 0; color: #6c757d;">Quantity: {{ item.quantity }}</p>
                <p style="margin: 5px 0;">₹{{ item.total_price|floatformat:2 }}</p>
            </div>
        </div>
    {% empty %}
        <p style="color: #6c757d;">No items found in this order.</p>
    {% endfor %}
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
        <a href="{% url 'user_orders' %}" class="btn-secondary">Back to Orders</a>
        {% if order.can_be_cancelled %}
            <a href="{% url 'cancel_order' order.order_number %}" class="btn-outline-danger">Cancel Order</a>
        {% endif %}
        {% if order.can_be_returned %}
            <a href="{% url 'return_order' order.order_number %}" class="btn-outline-danger">Request Return</a>
        {% endif %}
        <a href="{% url 'download_invoice' order.order_number %}" class="btn-primary">Download Invoice</a>
    </div>
</div>
{% endblock %}
