{% extends "admin/base_admin.html" %}
{% block title %}Admin Dashboard - Sitwell{% endblock %}

{% block body %}
  <!-- Enhanced Header -->
  <header class="bg-white shadow-sm border-b border-gray-100 px-8 py-5 flex-shrink-0">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-black" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Dashboard</h1>
        <p class="text-sm text-gray-500 mt-1">Welcome back, manage your store</p>
      </div>
      <div class="flex items-center space-x-6">
        <div class="flex items-center space-x-2 bg-gray-50 px-4 py-2 rounded-xl">
          <i class="fas fa-calendar-alt text-gray-400"></i>
          <span class="text-sm text-gray-600 font-medium">{{ today|date:"d M, Y" }}</span>
        </div>
        <div class="flex items-center space-x-3 bg-gradient-to-r from-blue-50 to-purple-50 px-4 py-2 rounded-xl">
          <div class="w-2 h-2 bg-green-500 rounded-full pulse"></div>
          <span class="text-sm font-bold text-gray-700">Farhaan</span>
          <span class="text-xs text-gray-500 font-medium">Admin</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Dashboard Content -->
  <main class="flex-1 overflow-auto p-8">
    <!-- Enhanced Metrics Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-10">
      <!-- Today's Sales -->
      <div class="metric-card bg-white rounded-2xl p-8 shadow-lg border-2 border-gray-100 fade-in">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-3">
              <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-shopping-cart text-white text-xl"></i>
              </div>
              <p class="text-sm font-bold text-gray-500 uppercase tracking-wide">Today's Sales</p>
            </div>
            <p class="text-4xl font-black text-gray-900 mb-2">₹{{ today_sales|floatformat:0 }}</p>
            <p class="text-sm text-gray-500">
              <span class="text-blue-600 font-semibold">{{ today_orders_count }} order{{ today_orders_count|pluralize }}</span> today
            </p>
          </div>
          <div class="relative w-20 h-20 flex-shrink-0">
            <svg class="w-20 h-20 progress-ring" viewBox="0 0 42 42">
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#e5e7eb" stroke-width="3"/>
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#3b82f6" stroke-width="3" 
                      stroke-dasharray="0 100" stroke-linecap="round" class="progress-ring-circle"/>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span class="text-sm font-black text-blue-600">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Today's Revenue -->
      <div class="metric-card bg-white rounded-2xl p-8 shadow-lg border-2 border-gray-100 fade-in" style="animation-delay: 0.1s;">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-3">
              <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-dollar-sign text-white text-xl"></i>
              </div>
              <p class="text-sm font-bold text-gray-500 uppercase tracking-wide">Total Revenue</p>
            </div>
            <p class="text-4xl font-black text-gray-900 mb-2">₹{{ total_revenue|floatformat:0 }}</p>
            <p class="text-sm text-gray-500">
              <span class="text-green-600 font-semibold">All time</span> revenue
            </p>
          </div>
          <div class="relative w-20 h-20 flex-shrink-0">
            <svg class="w-20 h-20 progress-ring" viewBox="0 0 42 42">
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#e5e7eb" stroke-width="3"/>
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#10b981" stroke-width="3" 
                      stroke-dasharray="0 100" stroke-linecap="round" class="progress-ring-circle"/>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span class="text-sm font-black text-emerald-600">0%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Users Count -->
      <div class="metric-card bg-white rounded-2xl p-8 shadow-lg border-2 border-gray-100 fade-in" style="animation-delay: 0.2s;">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <div class="flex items-center space-x-2 mb-3">
              <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-users text-white text-xl"></i>
              </div>
              <p class="text-sm font-bold text-gray-500 uppercase tracking-wide">Total Users</p>
            </div>
            <p class="text-4xl font-black text-gray-900 mb-2">{{ total_users }}</p>
            <p class="text-sm text-gray-500">
              <span class="text-purple-600 font-semibold">Registered</span> customers
            </p>
          </div>
          <div class="relative w-20 h-20 flex-shrink-0">
            <svg class="w-20 h-20 progress-ring" viewBox="0 0 42 42">
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#e5e7eb" stroke-width="3"/>
              <circle cx="21" cy="21" r="15.915" fill="transparent" stroke="#a855f7" stroke-width="3" 
                      stroke-dasharray="0 100" stroke-linecap="round" class="progress-ring-circle"/>
            </svg>
            <div class="absolute inset-0 flex items-center justify-center">
              <span class="text-sm font-black text-purple-600">0%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Latest Orders Section -->
    <div class="bg-white rounded-2xl shadow-lg border-2 border-gray-100 overflow-hidden fade-in" style="animation-delay: 0.3s;">
      <div class="px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-2xl font-black text-gray-900">Latest Orders</h2>
            <p class="text-sm text-gray-500 mt-1">Track and manage recent orders</p>
          </div>
          <a href="{% url 'order-list' %}" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all">
            <i class="fas fa-eye mr-2"></i>View All Orders
          </a>
        </div>
      </div>
      
      {% if recent_orders %}
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50 border-b-2 border-gray-200">
            <tr>
              <th class="px-6 py-4 text-left text-xs font-black text-gray-700 uppercase tracking-wider">Order ID</th>
              <th class="px-6 py-4 text-left text-xs font-black text-gray-700 uppercase tracking-wider">Customer</th>
              <th class="px-6 py-4 text-left text-xs font-black text-gray-700 uppercase tracking-wider">Date</th>
              <th class="px-6 py-4 text-right text-xs font-black text-gray-700 uppercase tracking-wider">Amount</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            {% for order in recent_orders %}
            <tr class="hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all cursor-pointer" onclick="window.location='{% url 'order-detail' order.id %}'">
              <td class="px-6 py-4">
                <span class="font-bold text-purple-600">#{{ order.order_number }}</span>
              </td>
              <td class="px-6 py-4">
                <div class="flex items-center">
                  <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold mr-3">
                    {{ order.user.first_name.0|upper }}{{ order.user.last_name.0|upper }}
                  </div>
                  <div>
                    <p class="font-bold text-gray-900">{{ order.user.first_name }} {{ order.user.last_name }}</p>
                    <p class="text-xs text-gray-500">{{ order.user.email }}</p>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 text-sm text-gray-600">
                {{ order.created_at|date:"d M Y" }}
              </td>
              <td class="px-6 py-4 text-right">
                <span class="text-lg font-black text-purple-600">₹{{ order.total_amount|floatformat:2 }}</span>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="p-8 text-center">
        <div class="inline-flex items-center justify-center w-24 h-24 bg-gray-100 rounded-full mb-6">
          <i class="fas fa-shopping-bag text-4xl text-gray-400"></i>
        </div>
        <h3 class="text-xl font-bold text-gray-900 mb-2">No Orders Yet</h3>
        <p class="text-gray-500 mb-6">Orders will appear here once customers start making purchases</p>
        <a href="{% url 'order-list' %}" class="px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all inline-block">
          <i class="fas fa-eye mr-2"></i>View All Orders
        </a>
      </div>
      {% endif %}
    </div>
  </main>

  <style>
    .metric-card {
      transition: all 0.3s ease;
    }
    .metric-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 60px rgba(102, 126, 234, 0.2);
    }
    
    .progress-ring {
      transform: rotate(-90deg);
    }
    .progress-ring-circle {
      transition: stroke-dasharray 0.35s, stroke 0.35s;
      transform-origin: 50% 50%;
    }
    
    .fade-in {
      animation: fadeIn 0.6s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .pulse {
      animation: pulse 2s ease-in-out infinite;
    }
  </style>
{% endblock %}
